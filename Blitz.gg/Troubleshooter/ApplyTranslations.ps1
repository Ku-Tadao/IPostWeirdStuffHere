$translations = @{
    "de-DE" = @{
        appDescription = "Identifiziere und behebe Probleme mit deiner Blitz-Installation.";
        txtSeparator = "  •  ";
        hdrFixAllIssues = "Alle Probleme beheben";
        descFixAllIssues = "Alle Schritte zur Fehlerbehebung automatisch ausführen, um häufige Probleme zu lösen.";
        btnQuickFix = "Schnellkorrektur";
        hdrClearCache = "Cache leeren";
        descClearCache = "Lokale temporäre Dateien entfernen und den Anwendungsstatus zurücksetzen.";
        btnCleanCache = "Cache bereinigen";
        hdrKillProcesses = "Prozesse beenden";
        descKillProcesses = "Alle laufenden Blitz- und spielbezogenen Prozesse gewaltsam schließen.";
        btnTerminate = "Beenden";
        hdrPortableVersion = "Portable Version";
        descPortableVersion = "Lade eine eigenständige Version von Blitz herunter, die keine Installation erfordert.";
        btnDownload = "Herunterladen";
        descRunningGames = "Erkennung unterstützter Spiele, die derzeit auf deinem System laufen.";
        statusRunning = "LÄUFT";
        hdrNoGamesDetected = "Keine Spiele erkannt";
        descNoGamesDetected = "Starte ein Spiel, um die Erkennung zu überprüfen";
        btnScanGames = "Nach Spiele scannen";
        tooltipRefreshStatus = "Status aktualisieren"
    };
    "fr-FR" = @{
        appDescription = "Identifiez et résolvez les problèmes avec votre installation Blitz.";
        txtSeparator = "  •  ";
        hdrFixAllIssues = "Réparer tous les problèmes";
        descFixAllIssues = "Exécuter toutes les étapes de dépannage automatiquement pour corriger les problèmes courants.";
        btnQuickFix = "Réparation rapide";
        hdrClearCache = "Vider le cache";
        descClearCache = "Supprimer les fichiers temporaires locaux et réinitialiser l'état de l'application.";
        btnCleanCache = "Nettoyer le cache";
        hdrKillProcesses = "Tuer les processus";
        descKillProcesses = "Fermer de force tous les processus Blitz et liés aux jeux en cours d'exécution.";
        btnTerminate = "Terminer";
        hdrPortableVersion = "Version Portable";
        descPortableVersion = "Téléchargez une version autonome de Blitz qui ne nécessite pas d'installation.";
        btnDownload = "Télécharger";
        descRunningGames = "Détection des jeux pris en charge en cours d'exécution sur votre système.";
        statusRunning = "EN COURS";
        hdrNoGamesDetected = "Aucun jeu détecté";
        descNoGamesDetected = "Lancez un jeu pour vérifier la détection";
        btnScanGames = "Scanner les jeux";
        tooltipRefreshStatus = "Actualiser le statut"
    };
    "id-ID" = @{
        appDescription = "Identifikasi dan selesaikan masalah dengan instalasi Blitz Anda.";
        txtSeparator = "  •  ";
        hdrFixAllIssues = "Perbaiki Semua Masalah";
        descFixAllIssues = "Jalankan semua langkah pemecahan masalah secara otomatis untuk memperbaiki masalah umum.";
        btnQuickFix = "Perbaikan Cepat";
        hdrClearCache = "Bersihkan Cache";
        descClearCache = "Hapus file sementara lokal dan atur ulang status aplikasi.";
        btnCleanCache = "Bersihkan Cache";
        hdrKillProcesses = "Hentikan Proses";
        descKillProcesses = "Tutup paksa semua proses Blitz dan game yang sedang berjalan.";
        btnTerminate = "Hentikan";
        hdrPortableVersion = "Versi Portabel";
        descPortableVersion = "Unduh versi mandiri Blitz yang tidak memerlukan instalasi.";
        btnDownload = "Unduh";
        descRunningGames = "Deteksi game yang didukung yang sedang berjalan di sistem Anda.";
        statusRunning = "BERJALAN";
        hdrNoGamesDetected = "Tidak ada game terdeteksi";
        descNoGamesDetected = "Mulai game untuk memverifikasi deteksi";
        btnScanGames = "Pindai Game";
        tooltipRefreshStatus = "Segarkan Status"
    };
    "pl-PL" = @{
        appDescription = "Zidentyfikuj i rozwiąż problemy z instalacją Blitz.";
        txtSeparator = "  •  ";
        hdrFixAllIssues = "Napraw wszystkie problemy";
        descFixAllIssues = "Uruchom wszystkie kroki rozwiązywania problemów automatycznie, aby naprawić typowe błędy.";
        btnQuickFix = "Szybka naprawa";
        hdrClearCache = "Wyczyść pamięć podręczną";
        descClearCache = "Usuń lokalne pliki tymczasowe i zresetuj stan aplikacji.";
        btnCleanCache = "Wyczyść cache";
        hdrKillProcesses = "Zakończ procesy";
        descKillProcesses = "Wymuś zamknięcie wszystkich uruchomionych procesów Blitz i powiązanych gier.";
        btnTerminate = "Zakończ";
        hdrPortableVersion = "Wersja przenośna";
        descPortableVersion = "Pobierz samodzielną wersję Blitz, która nie wymaga instalacji.";
        btnDownload = "Pobierz";
        descRunningGames = "Wykrywanie obsługiwanych gier aktualnie uruchomionych w systemie.";
        statusRunning = "URUCHOMIONE";
        hdrNoGamesDetected = "Nie wykryto gier";
        descNoGamesDetected = "Uruchom grę, aby zweryfikować wykrywanie";
        btnScanGames = "Skanuj gry";
        tooltipRefreshStatus = "Odśwież status"
    };
    "pt-PT" = @{
        appDescription = "Identifique e resolva problemas com a sua instalação do Blitz.";
        txtSeparator = "  •  ";
        hdrFixAllIssues = "Corrigir Todos os Problemas";
        descFixAllIssues = "Execute todas as etapas de resolução de problemas automaticamente para corrigir problemas comuns.";
        btnQuickFix = "Correção Rápida";
        hdrClearCache = "Limpar Cache";
        descClearCache = "Remova ficheiros temporários locais e redefina o estado da aplicação.";
        btnCleanCache = "Limpar Cache";
        hdrKillProcesses = "Encerrar Processos";
        descKillProcesses = "Feche forçosamente todos os processos do Blitz e relacionados com jogos em execução.";
        btnTerminate = "Terminar";
        hdrPortableVersion = "Versão Portátil";
        descPortableVersion = "Transfira uma versão autónoma do Blitz que não requer instalação.";
        btnDownload = "Transferir";
        descRunningGames = "Deteção de jogos suportados atualmente em execução no seu sistema.";
        statusRunning = "A EXECUTAR";
        hdrNoGamesDetected = "Nenhum jogo detetado";
        descNoGamesDetected = "Inicie um jogo para verificar a deteção";
        btnScanGames = "Procurar Jogos";
        tooltipRefreshStatus = "Atualizar Estado"
    };
    "ru-RU" = @{
        appDescription = "Выявление и устранение проблем с установкой Blitz.";
        txtSeparator = "  •  ";
        hdrFixAllIssues = "Исправить все проблемы";
        descFixAllIssues = "Автоматически выполнить все шаги по устранению неполадок для исправления общих проблем.";
        btnQuickFix = "Быстрое исправление";
        hdrClearCache = "Очистить кэш";
        descClearCache = "Удалить локальные временные файлы и сбросить состояние приложения.";
        btnCleanCache = "Очистить";
        hdrKillProcesses = "Завершить процессы";
        descKillProcesses = "Принудительно закрыть все запущенные процессы Blitz и игр.";
        btnTerminate = "Завершить";
        hdrPortableVersion = "Портативная версия";
        descPortableVersion = "Скачать автономную версию Blitz, не требующую установки.";
        btnDownload = "Скачать";
        descRunningGames = "Обнаружение поддерживаемых игр, запущенных в вашей системе.";
        statusRunning = "ЗАПУЩЕНО";
        hdrNoGamesDetected = "Игры не обнаружены";
        descNoGamesDetected = "Запустите игру для проверки обнаружения";
        btnScanGames = "Сканировать игры";
        tooltipRefreshStatus = "Обновить статус"
    };
    "tr-TR" = @{
        appDescription = "Blitz kurulumunuzla ilgili sorunları belirleyin ve çözün.";
        txtSeparator = "  •  ";
        hdrFixAllIssues = "Tüm Sorunları Düzelt";
        descFixAllIssues = "Yaygın sorunları düzeltmek için tüm sorun giderme adımlarını otomatik olarak çalıştırın.";
        btnQuickFix = "Hızlı Düzeltme";
        hdrClearCache = "Önbelleği Temizle";
        descClearCache = "Yerel geçici dosyaları kaldırın ve uygulama durumunu sıfırlayın.";
        btnCleanCache = "Temizle";
        hdrKillProcesses = "İşlemleri Sonlandır";
        descKillProcesses = "Çalışan tüm Blitz ve oyunla ilgili işlemleri zorla kapatın.";
        btnTerminate = "Sonlandır";
        hdrPortableVersion = "Taşınabilir Sürüm";
        descPortableVersion = "Kurulum gerektirmeyen bağımsız bir Blitz sürümünü indirin.";
        btnDownload = "İndir";
        descRunningGames = "Sisteminizde çalışan desteklenen oyunların tespiti.";
        statusRunning = "ÇALIŞIYOR";
        hdrNoGamesDetected = "Oyun algılanmadı";
        descNoGamesDetected = "Algılamayı doğrulamak için bir oyun başlatın";
        btnScanGames = "Oyunları Tara";
        tooltipRefreshStatus = "Durumu Yenile"
    };
}

$resourcePath = "Resources\Localization"

foreach ($lang in $translations.Keys) {
    $fileName = "StringResource.$lang.xaml"
    $filePath = Join-Path $resourcePath $fileName
    
    if (Test-Path $filePath) {
        $content = Get-Content $filePath -Raw -Encoding UTF8
        
        # Remove the previous placeholder block if it exists (simplistic removal based on comment)
        if ($content -match "<!-- New UI Resources -->") {
             $content = $content -replace "(?s)<!-- New UI Resources -->.*</ResourceDictionary>", "</ResourceDictionary>"
        }

        # Build new XML block
        $newBlock = @"
    <!-- New UI Resources -->
    <system:String x:Key="appDescription">$($translations[$lang].appDescription)</system:String>
    <system:String x:Key="txtSeparator">$($translations[$lang].txtSeparator)</system:String>
    
    <system:String x:Key="hdrFixAllIssues">$($translations[$lang].hdrFixAllIssues)</system:String>
    <system:String x:Key="descFixAllIssues">$($translations[$lang].descFixAllIssues)</system:String>
    <system:String x:Key="btnQuickFix">$($translations[$lang].btnQuickFix)</system:String>
    
    <system:String x:Key="hdrClearCache">$($translations[$lang].hdrClearCache)</system:String>
    <system:String x:Key="descClearCache">$($translations[$lang].descClearCache)</system:String>
    <system:String x:Key="btnCleanCache">$($translations[$lang].btnCleanCache)</system:String>
    
    <system:String x:Key="hdrKillProcesses">$($translations[$lang].hdrKillProcesses)</system:String>
    <system:String x:Key="descKillProcesses">$($translations[$lang].descKillProcesses)</system:String>
    <system:String x:Key="btnTerminate">$($translations[$lang].btnTerminate)</system:String>
    
    <system:String x:Key="hdrPortableVersion">$($translations[$lang].hdrPortableVersion)</system:String>
    <system:String x:Key="descPortableVersion">$($translations[$lang].descPortableVersion)</system:String>
    <system:String x:Key="btnDownload">$($translations[$lang].btnDownload)</system:String>
    
    <system:String x:Key="descRunningGames">$($translations[$lang].descRunningGames)</system:String>
    <system:String x:Key="statusRunning">$($translations[$lang].statusRunning)</system:String>
    <system:String x:Key="hdrNoGamesDetected">$($translations[$lang].hdrNoGamesDetected)</system:String>
    <system:String x:Key="descNoGamesDetected">$($translations[$lang].descNoGamesDetected)</system:String>
    <system:String x:Key="btnScanGames">$($translations[$lang].btnScanGames)</system:String>
    <system:String x:Key="tooltipRefreshStatus">$($translations[$lang].tooltipRefreshStatus)</system:String>

</ResourceDictionary>
"@
        
        # Insert before closing tag (assuming clean file structure or previous cleanup)
        $content = $content -replace "</ResourceDictionary>", $newBlock
        
        Set-Content -Path $filePath -Value $content -Encoding UTF8
        Write-Host "Updated translation for $lang"
    } else {
        Write-Host "File not found: $fileName"
    }
}
